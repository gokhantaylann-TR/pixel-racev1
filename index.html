<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>8-Bit Retro Racer</title>
<style>
body {
    margin: 0;
    background: #222;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: 'Courier New', monospace;
    color: white;
    overflow: hidden;
}
.game-wrapper { position: relative; }
canvas { border: 4px solid #fff; background: #444; display: block; }
.ui {
    position: absolute;
    top: 20px;
    width: 100%;
    text-align: center;
    pointer-events: none;
}
.brand {
    position: absolute;
    top: 15px;
    right: 20px;
    text-align: center;
}
.brand .title { font-size: 11px; }
.brand .author { font-size: 10px; opacity: 0.8; }
/* ALT TUŞLAR */
.controls {
    position: absolute;
    bottom: -115px;
    width: 100%;
    display: flex;
    justify-content: space-between;
    padding: 0 25px;
}
.control-group { display: flex; gap: 10px; }
.btn {
    width: 56px;
    height: 56px;
    border: 3px solid #fff;
    background: #333;
    color: #fff;
    font-size: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
}
.btn:active { background: #666; }
</style>
</head>
<body>
<div class="game-wrapper">
    <div class="ui">
        <h1 id="score">SKOR: 0</h1>
        <p id="msg">TIKLA → BAŞLA | P: PAUSE</p>
    </div>
    <div class="brand">
        <div class="title">MAT GAMES</div>
        <div class="author">by gokhantaylan</div>
    </div>
    <canvas id="gameCanvas" width="400" height="600"></canvas>

    <div class="controls">
        <div class="control-group">
            <div class="btn" data-key="ArrowLeft">◀</div>
            <div class="btn" data-key="ArrowRight">▶</div>
        </div>
        <div class="control-group">
            <div class="btn" data-key="ArrowUp">▲</div>
            <div class="btn" data-key="ArrowDown">▼</div>
        </div>
    </div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const scoreElement = document.getElementById("score");
const msgElement = document.getElementById("msg");

let gameRunning = false;
let paused = false;
let score = 0;
let speed = 5;
let frame = 0;

const ROAD = {
    width: 220,
    lanes: 3,
    curveAmp: 60,
    curveFreq: 0.002
};

const player = {
    lane: 1,
    y: 480,
    w: 40,
    h: 70,
    color: "#e74c3c"
};

let enemies = [];
let keys = {};

/* INPUT */
window.addEventListener("keydown", e => {
    keys[e.code] = true;
    if(e.code === "KeyP") paused = !paused;
});
window.addEventListener("keyup", e => keys[e.code] = false);
document.querySelectorAll(".btn").forEach(btn => {
    const key = btn.dataset.key;
    btn.addEventListener("mousedown", () => keys[key]=true);
    btn.addEventListener("mouseup", () => keys[key]=false);
    btn.addEventListener("touchstart", () => keys[key]=true);
    btn.addEventListener("touchend", () => keys[key]=false);
});
canvas.addEventListener("click", () => { if(!gameRunning){ resetGame(); gameRunning=true; update(); }});

/* RESET */
function resetGame(){
    score = 0; speed = 5; frame = 0;
    enemies = [];
    player.lane = 1;
    paused = false;
    msgElement.innerText = "";
    scoreElement.innerText = "SKOR: 0";
}

/* ROAD HELPER */
function roadCenter(){
    return canvas.width/2 + Math.sin(frame*ROAD.curveFreq)*ROAD.curveAmp;
}
function laneX(lane){
    const laneWidth = ROAD.width / ROAD.lanes;
    return roadCenter() - ROAD.width/2 + laneWidth*(lane+0.5) - player.w/2;
}

/* DRAW CAR */
function drawCar(obj){
    ctx.fillStyle=obj.color;
    ctx.fillRect(obj.x,obj.y,obj.w,obj.h);
    ctx.fillStyle="#000";
    ctx.fillRect(obj.x-5,obj.y+10,5,15);
    ctx.fillRect(obj.x+obj.w,obj.y+10,5,15);
    ctx.fillRect(obj.x-5,obj.y+45,5,15);
    ctx.fillRect(obj.x+obj.w,obj.y+45,5,15);
    ctx.fillStyle="#ecf0f1";
    ctx.fillRect(obj.x+5,obj.y+15,obj.w-10,18);
}

/* DRAW ROAD */
function drawRoad(){
    ctx.fillStyle="#2ecc71"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#555"; ctx.fillRect(roadCenter()-ROAD.width/2,0,ROAD.width,canvas.height);
    ctx.strokeStyle="#fff"; ctx.setLineDash([20,20]);
    for(let i=1;i<ROAD.lanes;i++){
        const x = roadCenter()-ROAD.width/2 + i*(ROAD.width/ROAD.lanes);
        ctx.beginPath();
        ctx.moveTo(x,0);
        ctx.lineTo(x,canvas.height);
        ctx.stroke();
    }
}

/* SPAWN ENEMY */
function spawnEnemy(){
    if(frame % 60 === 0){
        enemies.push({lane:Math.floor(Math.random()*3),y:-70,w:40,h:70,color:"#3498db"});
    }
}

/* UPDATE */
function update(){
    if(!gameRunning || paused) return;
    frame++;
    ctx.clearRect(0,0,canvas.width,canvas.height);

    drawRoad();

    if(keys.ArrowLeft && player.lane>0) player.lane--;
    if(keys.ArrowRight && player.lane<2) player.lane++;

    player.x = laneX(player.lane);
    drawCar(player);

    spawnEnemy();
    enemies.forEach((e,i)=>{
        e.y += speed;
        e.x = laneX(e.lane);
        drawCar(e);

        if(player.x<e.x+e.w && player.x+player.w>e.x &&
           player.y<e.y+e.h && player.y+player.h>e.y){
            gameOver();
        }

        if(e.y>canvas.height){
            enemies.splice(i,1);
            score++; scoreElement.innerText="SKOR: "+score;
            if(score%10===0) speed+=0.2;
        }
    });

    requestAnimationFrame(update);
}

function gameOver(){
    gameRunning=false;
    msgElement.innerText="OYUN BİTTİ! TIKLA TEKRAR";
}

/* INITIAL DRAW */
drawRoad();
player.x = laneX(player.lane);
drawCar(player);

</script>
</body>
</html>