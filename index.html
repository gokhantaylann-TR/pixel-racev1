<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8-Bit Retro Racer | Gökhan Edition</title>
    <style>
        body { margin: 0; background: #1a1a1a; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; font-family: 'Courier New', monospace; color: white; overflow: hidden; }
        .game-wrapper { position: relative; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        canvas { border: 6px solid #333; background: #444; display: block; image-rendering: pixelated; }
        .ui { position: absolute; top: 20px; width: 100%; text-align: center; pointer-events: none; text-shadow: 2px 2px #000; }
        .brand { position: absolute; top: 15px; right: 20px; text-align: right; }
        .brand .title { font-size: 14px; font-weight: bold; color: #f1c40f; }
        .brand .author { font-size: 11px; opacity: 0.9; color: #e74c3c; }
        .controls-info { margin-top: 15px; color: #888; font-size: 12px; }
        #msg { background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="game-wrapper">
        <div class="ui">
            <h2 id="score">SKOR: 0</h2>
            <div id="msg">BAŞLAMAK İÇİN TIKLA</div>
        </div>
        <div class="brand">
            <div class="title">ZETAŞ RACING</div>
            <div class="author">dev: gokhantaylan</div>
        </div>
        <canvas id="gameCanvas" width="400" height="600"></canvas>
    </div>

    <div class="controls-info">Yön Tuşları: Hareket | P: Duraklat</div>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreElement = document.getElementById("score");
    const msgElement = document.getElementById("msg");

    // Ayarlar
    let gameRunning = false;
    let paused = false;
    let score = 0;
    let speed = 7;
    let frame = 0;
    
    const ROAD_WIDTH = 260;
    const LANES = 3;
    const LANE_W = ROAD_WIDTH / LANES;

    // Oyuncu (Favori renklerinle güncellendi)
    const player = {
        lane: 1,
        targetX: 0,
        currentX: 0,
        y: 480,
        w: 44,
        h: 75,
        color: "#e74c3c" // GS Kırmızısı
    };

    let enemies = [];

    // Giriş Kontrolü (Debouncing eklendi)
    window.addEventListener("keydown", e => {
        if (!gameRunning) return;
        if (e.code === "KeyP") paused = !paused;
        
        if (!paused) {
            if (e.code === "ArrowLeft" && player.lane > 0) player.lane--;
            if (e.code === "ArrowRight" && player.lane < LANES - 1) player.lane++;
        }
    });

    canvas.addEventListener("click", () => {
        if (!gameRunning) {
            resetGame();
            gameRunning = true;
            update();
        }
    });

    function resetGame() {
        score = 0; speed = 7; frame = 0;
        enemies = [];
        player.lane = 1;
        player.currentX = getLaneX(1);
        player.targetX = player.currentX;
        paused = false;
        msgElement.style.display = "none";
        scoreElement.innerText = "SKOR: 0";
    }

    function getLaneX(lane) {
        return (canvas.width / 2 - ROAD_WIDTH / 2) + (lane * LANE_W) + (LANE_W / 2 - player.w / 2);
    }

    function drawCar(x, y, color, isPlayer = false) {
        // Gövde
        ctx.fillStyle = color;
        ctx.fillRect(x, y, player.w, player.h);
        
        // Detaylar (GS Sarısı detay)
        if(isPlayer) {
            ctx.fillStyle = "#f1c40f"; 
            ctx.fillRect(x + 5, y + 5, player.w - 10, 5); 
        }

        // Tekerlekler
        ctx.fillStyle = "#111";
        ctx.fillRect(x - 4, y + 10, 6, 18);
        ctx.fillRect(x + player.w - 2, y + 10, 6, 18);
        ctx.fillRect(x - 4, y + 50, 6, 18);
        ctx.fillRect(x + player.w - 2, y + 50, 6, 18);

        // Cam
        ctx.fillStyle = "rgba(255,255,255,0.7)";
        ctx.fillRect(x + 6, y + 15, player.w - 12, 20);
    }

    function drawRoad() {
        // Çimen
        ctx.fillStyle = "#27ae60";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Asfalt
        const roadX = canvas.width / 2 - ROAD_WIDTH / 2;
        ctx.fillStyle = "#34495e";
        ctx.fillRect(roadX, 0, ROAD_WIDTH, canvas.height);

        // Şerit Çizgileri
        ctx.strokeStyle = "#ecf0f1";
        ctx.setLineDash([30, 30]);
        ctx.lineDashOffset = -frame * speed;
        ctx.lineWidth = 4;
        
        for (let i = 1; i < LANES; i++) {
            ctx.beginPath();
            ctx.moveTo(roadX + i * LANE_W, 0);
            ctx.lineTo(roadX + i * LANE_W, canvas.height);
            ctx.stroke();
        }
    }

    function update() {
        if (!gameRunning || paused) {
            if(paused) msgElement.innerText = "DURAKLATILDI";
            requestAnimationFrame(update);
            return;
        }

        frame++;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawRoad();

        // Oyuncu Yumuşak Hareket (Lerp)
        player.targetX = getLaneX(player.lane);
        player.currentX += (player.targetX - player.currentX) * 0.2;
        drawCar(player.currentX, player.y, player.color, true);

        // Düşmanlar
        if (frame % 45 === 0) {
            enemies.push({
                lane: Math.floor(Math.random() * 3),
                y: -100,
                color: "#2980b9"
            });
        }

        enemies.forEach((en, index) => {
            en.y += speed;
            const enX = getLaneX(en.lane);
            drawCar(enX, en.y, en.color);

            // Çarpışma (Hitbox biraz daraltıldı daha adil olması için)
            if (
                player.currentX < enX + player.w - 5 &&
                player.currentX + player.w - 5 > enX &&
                player.y < en.y + player.h - 5 &&
                player.y + player.h - 5 > en.y
            ) {
                gameOver();
            }

            // Skor ve Temizlik
            if (en.y > canvas.height) {
                enemies.splice(index, 1);
                score++;
                scoreElement.innerText = `SKOR: ${score}`;
                if (score % 5 === 0) speed += 0.15;
            }
        });

        requestAnimationFrame(update);
    }

    function gameOver() {
        gameRunning = false;
        msgElement.style.display = "block";
        msgElement.innerText = "OYUN BİTTİ! YENİDEN BAŞLA";
    }

    // İlk kare
    drawRoad();
    drawCar(getLaneX(1), player.y, player.color, true);

</script>
</body>
</html>
